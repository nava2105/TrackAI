import os
import joblib
import pandas as pd
from mido import MidiFile
from sklearn.preprocessing import MultiLabelBinarizer
from sklearn.neural_network import MLPClassifier  # Using Neuronal network
import re  # For cleaning chord names

# Paths
train_midi_folder = "C:/Users/Mateo/Documents/UCE/2024 - 2025/mineria/7200 fichiers MIDI accords piano - Ressource/training"


# Function to parse MIDI files and extract chord data
def parse_midi(midi_path):
    midi = MidiFile(midi_path)
    chords = []

    for track in midi.tracks:
        chord_name = None
        notes = []
        for msg in track:
            if msg.type == 'track_name':  # Extract chord name
                chord_name = msg.name.strip()
                chord_name = chord_name.split(" ")[-1]  # Take last substring as chord name
            if msg.type == 'note_on' and msg.velocity > 0:
                notes.append(msg.note)

        if chord_name and notes:
            chords.append({"chord": chord_name, "notes": sorted(notes)})

    return chords


# Process all MIDI files in training folder
midi_data = []
for file in os.listdir(train_midi_folder):
    if file.endswith(".mid"):
        midi_data.extend(parse_midi(os.path.join(train_midi_folder, file)))

# Convert to DataFrame
df = pd.DataFrame(midi_data)

# Encode notes as binary features
mlb = MultiLabelBinarizer()
X = mlb.fit_transform(df['notes'])  # Convert lists to a feature matrix
y = df['chord']

# Train the model with Random Forest
model = MLPClassifier(hidden_layer_sizes=(450, 300, 200, 100, 50, 25), max_iter=1000, random_state=42)
model.fit(X, y)

# Save model and encoder
joblib.dump(model, "../model/chord_classifier.pkl")
joblib.dump(mlb, "../model/notes_encoder.pkl")

print("Model training complete. Model saved as 'chord_classifier.pkl' and encoder as 'notes_encoder.pkl'.")

""""
Model Accuracy: 0.87
Testing complete. Results saved in 'test_results.csv'.
                                 filename  chord predicted_chord
0       Aug-Aug-Aug-Aug-Aug-I-VI - G2.mid     G2              G2
1     Aug-Aug-Aug-Aug-Aug-ii-VII - G2.mid     G2              G2
2      Aug-Aug-Aug-Aug-Aug-iii-i - G2.mid     G2              G2
3      Aug-Aug-Aug-Aug-Aug-IV-ii - G2.mid     G2              G2
4      Aug-Aug-Aug-Aug-Aug-V-III - G2.mid     G2              G2
...                                   ...    ...             ...
6960                    vii-v - Gmaj7.mid  Gmaj7             GM7
6961                    vii-v - Gmaj9.mid  Gmaj9           Gmaj9
6962                     vii-v - GmM7.mid   GmM7            GmM7
6963                    vii-v - Gsus2.mid  Gsus2           Gsus2
6964                    vii-v - Gsus4.mid  Gsus4           Gsus4

[6965 rows x 3 columns]
Classification Report:
              precision    recall  f1-score   support

           A       0.75      1.00      0.86         6
         A#2       1.00      0.80      0.89         5
         A#6       0.95      0.95      0.95        20
        A#69       1.00      0.80      0.89         5
         A#7       1.00      0.80      0.89         5
      A#7+11       1.00      0.80      0.89         5
       A#7+5       1.00      0.80      0.89         5
       A#7-5       1.00      0.80      0.89         5
       A#7-9       1.00      0.80      0.89         5
     A#7sus4       0.80      0.80      0.80         5
         A#9       0.80      0.80      0.80         5
     A#9sus4       1.00      0.80      0.89         5
      A#M7+5       1.00      0.60      0.75         5
     A#add11       1.00      0.80      0.89         5
      A#add9       1.00      0.80      0.89         5
       A#dim       1.00      1.00      1.00         6
      A#dim6       1.00      0.80      0.89         5
        A#m6       1.00      0.80      0.89         5
       A#m69       0.67      0.80      0.73         5
        A#m7       0.75      0.60      0.67         5
      A#m7-5       1.00      0.50      0.67         6
    A#m7b9b5       1.00      1.00      1.00         6
        A#m9       1.00      0.80      0.89         5
       A#mM7       0.80      0.80      0.80         5
     A#madd9       1.00      0.80      0.89         5
      A#maj7       1.00      0.80      0.89         5
      A#maj9       1.00      0.80      0.89         5
      A#sus2       1.00      0.80      0.89         5
      A#sus4       1.00      0.80      0.89         5
          A2       0.72      0.93      0.81        28
          A6       1.00      1.00      1.00         7
         A69       1.00      1.00      1.00         7
          A7       1.00      1.00      1.00         9
       A7+11       1.00      1.00      1.00         7
        A7+5       1.00      1.00      1.00         7
        A7-5       0.88      1.00      0.93         7
        A7-9       1.00      1.00      1.00         7
      A7sus4       1.00      1.00      1.00         7
          A9       1.00      1.00      1.00         9
      A9sus4       1.00      1.00      1.00         7
         AM7       0.91      0.83      0.87        24
       AM7+5       1.00      1.00      1.00         7
         AM9       1.00      0.78      0.88        18
      Aadd11       1.00      1.00      1.00         7
       Aadd9       1.00      0.68      0.81        28
          Ab       1.00      1.00      1.00         6
         Ab2       0.95      0.75      0.84        24
         Ab6       0.87      0.81      0.84        32
        Ab69       0.89      1.00      0.94        32
         Ab7       0.77      0.96      0.85        24
      Ab7+11       0.89      1.00      0.94        32
       Ab7+5       1.00      0.38      0.55         8
       Ab7-5       0.81      0.91      0.85        32
       Ab7-9       0.73      1.00      0.84         8
     Ab7sus4       0.90      0.88      0.89        32
         Ab9       0.88      0.96      0.92        24
     Ab9sus4       0.91      0.94      0.92        32
        AbM7       0.73      0.94      0.82        32
      AbM7+5       0.83      0.91      0.87        32
        AbM9       1.00      0.38      0.55         8
     Abadd11       0.89      0.97      0.93        32
      Abadd9       0.73      1.00      0.84        32
      Abdim6       0.89      0.97      0.93        32
         Abm       1.00      0.67      0.80         6
        Abm6       1.00      0.50      0.67         8
       Abm69       0.89      0.97      0.93        32
        Abm7       1.00      0.70      0.82        20
      Abm7-5       0.75      0.38      0.50         8
        Abm9       1.00      0.75      0.86        20
       AbmM7       0.62      0.62      0.62         8
     Abmadd9       0.86      1.00      0.93        32
      Abmaj7       0.89      0.71      0.79        24
      Abmaj9       0.96      0.75      0.84        32
      Absus2       0.85      0.88      0.86        32
      Absus4       0.92      0.75      0.83        32
        Adim       1.00      1.00      1.00         6
       Adim6       1.00      1.00      1.00         7
          Am       1.00      1.00      1.00         8
         Am6       1.00      1.00      1.00         7
        Am69       1.00      1.00      1.00         7
         Am7       1.00      1.00      1.00        10
       Am7-5       1.00      1.00      1.00         9
     Am7b9b5       1.00      1.00      1.00         6
         Am9       1.00      1.00      1.00        10
        AmM7       1.00      1.00      1.00         7
      Amadd9       1.00      1.00      1.00         7
       Amaj7       0.85      0.82      0.84        28
       Amaj9       0.90      1.00      0.95        28
       Asus2       1.00      1.00      1.00         7
       Asus4       1.00      1.00      1.00         7
           B       1.00      0.50      0.67         8
          B2       0.75      1.00      0.86        24
          B6       0.86      1.00      0.92         6
         B69       0.86      1.00      0.92         6
          B7       0.89      1.00      0.94         8
       B7+11       0.86      1.00      0.92         6
        B7+5       0.86      1.00      0.92         6
        B7-5       0.86      1.00      0.92         6
        B7-9       0.86      1.00      0.92         6
      B7sus4       0.86      1.00      0.92         6
          B9       0.89      1.00      0.94         8
      B9sus4       0.86      1.00      0.92         6
       BM7+5       0.86      1.00      0.92         6
      Badd11       0.86      1.00      0.92         6
       Badd9       1.00      0.75      0.86        24
          Bb       1.00      1.00      1.00         6
         Bb2       1.00      0.75      0.86        24
         Bb6       0.95      1.00      0.97        18
        Bb69       0.86      1.00      0.92         6
         Bb7       0.89      1.00      0.94         8
      Bb7+11       0.86      1.00      0.92         6
       Bb7+5       0.86      1.00      0.92         6
       Bb7-5       0.89      1.00      0.94        24
       Bb7-9       0.86      1.00      0.92         6
     Bb7sus4       0.75      1.00      0.86         6
         Bb9       0.89      1.00      0.94         8
     Bb9sus4       0.86      1.00      0.92         6
        BbM7       1.00      0.90      0.95        20
      BbM7+5       0.86      1.00      0.92         6
        BbM9       1.00      0.80      0.89         5
     Bbadd11       0.75      1.00      0.86         6
      Bbadd9       0.72      0.96      0.82        24
      Bbdim6       0.79      0.96      0.87        24
         Bbm       1.00      1.00      1.00         6
        Bbm6       0.86      1.00      0.92         6
       Bbm69       0.86      1.00      0.92         6
        Bbm7       0.92      1.00      0.96        11
      Bbm7-5       0.79      0.92      0.85        24
        Bbm9       0.92      1.00      0.96        11
       BbmM7       0.86      1.00      0.92         6
     Bbmadd9       0.86      1.00      0.92         6
      Bbmaj7       0.88      0.96      0.92        24
      Bbmaj9       0.89      1.00      0.94        24
      Bbsus2       0.86      1.00      0.92         6
      Bbsus4       0.75      1.00      0.86         6
       Bdim6       0.86      1.00      0.92         6
          Bm       1.00      1.00      1.00         6
         Bm6       0.86      1.00      0.92         6
        Bm69       0.86      1.00      0.92         6
         Bm7       0.92      1.00      0.96        12
       Bm7-5       0.95      1.00      0.97        18
         Bm9       0.92      1.00      0.96        12
        BmM7       0.75      1.00      0.86         6
      Bmadd9       0.86      1.00      0.92         6
       Bmaj7       0.82      0.96      0.88        24
       Bmaj9       0.88      0.96      0.92        24
       Bsus2       0.96      0.92      0.94        24
       Bsus4       0.75      1.00      0.86         6
           C       1.00      1.00      1.00         8
         C#2       0.90      0.81      0.85        32
         C#6       0.89      0.78      0.83        32
        C#69       0.96      0.84      0.90        32
         C#7       0.57      1.00      0.73         8
      C#7+11       0.96      0.78      0.86        32
       C#7+5       0.89      1.00      0.94        32
       C#7-5       0.91      0.97      0.94        32
       C#7-9       0.91      0.97      0.94        32
     C#7sus4       0.86      0.97      0.91        32
         C#9       1.00      0.50      0.67         8
     C#9sus4       1.00      0.38      0.55         8
      C#M7+5       0.91      0.94      0.92        32
     C#add11       0.86      0.94      0.90        32
      C#add9       0.86      0.79      0.83        24
       C#dim       1.00      0.67      0.80         6
      C#dim6       1.00      0.78      0.88        32
         C#m       1.00      1.00      1.00         6
        C#m6       0.73      1.00      0.84         8
       C#m69       0.93      0.84      0.89        32
        C#m7       0.88      0.93      0.90        40
      C#m7-5       0.89      0.67      0.76        24
    C#m7b9b5       1.00      1.00      1.00         6
        C#m9       0.89      1.00      0.94        40
       C#mM7       0.73      1.00      0.84         8
     C#madd9       0.64      0.88      0.74         8
      C#maj7       0.71      1.00      0.83        32
      C#maj9       0.53      1.00      0.70         8
      C#sus2       0.73      1.00      0.84         8
      C#sus4       0.71      0.94      0.81        32
          C2       0.95      0.71      0.82        28
          C6       1.00      1.00      1.00         7
         C69       1.00      1.00      1.00         7
          C7       1.00      1.00      1.00         9
       C7+11       1.00      1.00      1.00         7
        C7+5       1.00      1.00      1.00         7
        C7-5       0.88      1.00      0.93         7
        C7-9       1.00      1.00      1.00         7
      C7sus4       1.00      1.00      1.00         7
          C9       1.00      1.00      1.00         9
      C9sus4       1.00      1.00      1.00         7
         CM7       1.00      0.80      0.89         5
       CM7+5       1.00      1.00      1.00         7
         CM9       1.00      0.80      0.89         5
      Cadd11       1.00      1.00      1.00         7
       Cadd9       0.80      1.00      0.89        28
          Cb       0.78      0.88      0.82        24
         Cb2       1.00      0.80      0.89         5
         Cb6       0.80      0.80      0.80         5
        Cb69       1.00      0.90      0.95        20
         Cb7       1.00      0.80      0.89         5
      Cb7+11       1.00      0.80      0.89         5
       Cb7+5       1.00      0.60      0.75         5
       Cb7-5       1.00      0.90      0.95        20
       Cb7-9       1.00      0.80      0.89         5
     Cb7sus4       1.00      0.80      0.89         5
         Cb9       1.00      0.80      0.89         5
     Cb9sus4       1.00      0.80      0.89         5
        CbM7       1.00      0.83      0.91        18
      CbM7+5       1.00      0.80      0.89         5
        CbM9       0.80      0.67      0.73         6
     Cbadd11       1.00      0.80      0.89         5
      Cbadd9       1.00      0.80      0.89         5
      Cbdim6       1.00      0.80      0.89         5
        Cbm6       1.00      0.80      0.89         5
       Cbm69       1.00      0.80      0.89         5
        Cbm7       1.00      0.80      0.89         5
      Cbm7-5       1.00      0.87      0.93        15
        Cbm9       1.00      0.40      0.57         5
       CbmM7       1.00      0.80      0.89         5
     Cbmadd9       1.00      0.80      0.89         5
      Cbmaj7       1.00      0.80      0.89         5
      Cbmaj9       1.00      0.80      0.89         5
      Cbsus2       1.00      0.95      0.97        20
      Cbsus4       1.00      0.80      0.89         5
        Cdim       1.00      1.00      1.00         6
       Cdim6       0.88      1.00      0.93         7
          Cm       1.00      1.00      1.00         6
         Cm6       1.00      1.00      1.00         7
        Cm69       1.00      1.00      1.00         7
         Cm7       1.00      1.00      1.00        12
       Cm7-5       1.00      1.00      1.00         9
     Cm7b9b5       1.00      1.00      1.00         6
         Cm9       1.00      1.00      1.00        12
        CmM7       1.00      1.00      1.00         7
      Cmadd9       1.00      1.00      1.00         7
       Cmaj7       0.90      1.00      0.95        28
       Cmaj9       0.88      1.00      0.93         7
       Csus2       1.00      1.00      1.00         7
       Csus4       1.00      1.00      1.00         7
           D       1.00      1.00      1.00         6
         D#2       1.00      0.83      0.91        18
         D#6       1.00      0.67      0.80         6
        D#69       1.00      0.88      0.93        24
         D#7       1.00      0.67      0.80         6
      D#7+11       1.00      0.67      0.80         6
       D#7+5       0.50      0.83      0.62         6
       D#7-5       1.00      0.67      0.80         6
       D#7-9       0.83      0.83      0.83        18
     D#7sus4       0.75      0.83      0.79        18
         D#9       1.00      0.50      0.67         6
     D#9sus4       0.95      0.83      0.89        24
      D#M7+5       0.71      0.83      0.77        18
     D#add11       0.88      0.83      0.86        18
      D#add9       0.96      0.87      0.91        30
       D#dim       0.75      1.00      0.86         6
      D#dim6       1.00      0.67      0.80         6
         D#m       0.94      0.83      0.88        18
        D#m6       0.67      0.67      0.67         6
       D#m69       1.00      0.67      0.80         6
        D#m7       0.89      0.71      0.79        24
      D#m7-5       0.90      0.81      0.85        32
    D#m7b9b5       1.00      0.83      0.91         6
        D#m9       0.50      1.00      0.67         8
       D#mM7       0.55      1.00      0.71         6
     D#madd9       1.00      0.78      0.88        18
      D#maj7       0.94      0.89      0.91        18
      D#maj9       1.00      0.67      0.80         6
      D#sus2       1.00      0.50      0.67         6
      D#sus4       1.00      0.67      0.80         6
          D2       0.76      0.89      0.82        28
          D6       1.00      1.00      1.00         7
         D69       1.00      1.00      1.00         7
          D7       1.00      1.00      1.00         9
       D7+11       1.00      1.00      1.00         7
        D7+5       0.88      1.00      0.93         7
        D7-5       1.00      1.00      1.00         7
        D7-9       1.00      1.00      1.00         7
      D7sus4       1.00      1.00      1.00         7
          D9       1.00      1.00      1.00         9
      D9sus4       1.00      1.00      1.00         7
         DM7       1.00      0.61      0.76        18
       DM7+5       1.00      1.00      1.00         7
         DM9       0.91      0.83      0.87        24
      Dadd11       1.00      1.00      1.00         7
       Dadd9       0.90      0.68      0.78        28
          Db       1.00      1.00      1.00         6
         Db2       0.65      0.92      0.76        24
         Db6       0.75      0.50      0.60         6
        Db69       0.55      1.00      0.71         6
         Db7       1.00      0.70      0.82        20
      Db7+11       0.60      1.00      0.75         6
       Db7+5       1.00      0.50      0.67         6
       Db7-5       1.00      0.33      0.50         6
       Db7-9       0.75      0.50      0.60         6
     Db7sus4       1.00      0.50      0.67         6
         Db9       0.79      0.95      0.86        20
     Db9sus4       0.77      0.96      0.85        24
        DbM7       1.00      0.38      0.55         8
      DbM7+5       1.00      0.50      0.67         6
        DbM9       0.96      0.81      0.88        32
     Dbadd11       1.00      0.50      0.67         6
      Dbadd9       1.00      0.67      0.80        24
      Dbdim6       0.60      1.00      0.75         6
        Dbm6       1.00      0.83      0.91        24
       Dbm69       0.55      1.00      0.71         6
        Dbm7       1.00      0.72      0.84        18
      Dbm7-5       0.63      0.94      0.76        18
        Dbm9       1.00      0.83      0.91        18
       DbmM7       1.00      0.83      0.91        24
     Dbmadd9       0.90      0.79      0.84        24
      Dbmaj7       0.95      0.88      0.91        24
      Dbmaj9       1.00      0.78      0.88        18
      Dbsus2       0.83      0.83      0.83        24
      Dbsus4       1.00      0.50      0.67         6
        Ddim       0.75      1.00      0.86         6
       Ddim6       1.00      1.00      1.00         7
          Dm       0.88      0.88      0.88         8
         Dm6       1.00      1.00      1.00         7
        Dm69       1.00      1.00      1.00         7
         Dm7       1.00      1.00      1.00         9
       Dm7-5       1.00      1.00      1.00         9
     Dm7b9b5       1.00      1.00      1.00         6
         Dm9       1.00      1.00      1.00         9
        DmM7       1.00      1.00      1.00         7
      Dmadd9       0.88      1.00      0.93         7
       Dmaj7       0.90      0.93      0.91        28
       Dmaj9       0.90      1.00      0.95        28
       Dsus2       1.00      1.00      1.00         7
       Dsus4       0.88      1.00      0.93         7
           E       1.00      1.00      1.00         6
          E2       0.72      0.93      0.81        28
          E6       0.88      1.00      0.93         7
         E69       1.00      1.00      1.00         7
          E7       1.00      1.00      1.00         9
       E7+11       1.00      1.00      1.00         7
        E7+5       1.00      1.00      1.00         7
        E7-5       1.00      1.00      1.00         7
        E7-9       1.00      1.00      1.00         7
      E7sus4       1.00      1.00      1.00         7
          E9       1.00      1.00      1.00         9
      E9sus4       1.00      1.00      1.00         7
         EM7       0.93      0.72      0.81        18
       EM7+5       1.00      1.00      1.00         7
         EM9       1.00      0.50      0.67         6
      Eadd11       1.00      1.00      1.00         7
       Eadd9       1.00      0.61      0.76        28
          Eb       1.00      1.00      1.00         6
         Eb2       0.61      0.95      0.75        20
         Eb6       0.90      0.95      0.93        20
        Eb69       0.90      0.95      0.93        20
         Eb7       0.91      0.75      0.82        28
      Eb7+11       0.76      0.95      0.84        20
       Eb7+5       1.00      0.60      0.75        20
       Eb7-5       0.83      0.95      0.88        20
       Eb7-9       0.80      1.00      0.89        20
     Eb7sus4       0.84      0.80      0.82        20
         Eb9       0.84      0.96      0.90        28
     Eb9sus4       0.91      1.00      0.95        20
        EbM7       0.88      0.78      0.82        18
      EbM7+5       0.86      0.90      0.88        20
        EbM9       1.00      0.50      0.67         6
     Ebadd11       0.81      0.85      0.83        20
      Ebadd9       0.85      0.55      0.67        20
      Ebdim6       0.83      0.95      0.88        20
         Ebm       0.62      1.00      0.76         8
        Ebm6       0.76      0.95      0.84        20
       Ebm69       0.85      0.85      0.85        20
        Ebm7       0.71      0.84      0.77        32
      Ebm7-5       0.70      0.80      0.74        20
        Ebm9       0.95      0.66      0.78        32
       EbmM7       1.00      0.55      0.71        20
     Ebmadd9       0.83      0.95      0.88        20
      Ebmaj7       0.72      0.90      0.80        20
      Ebmaj9       0.77      0.85      0.81        20
      Ebsus2       0.65      0.85      0.74        20
      Ebsus4       0.86      0.90      0.88        20
        Edim       1.00      0.83      0.91         6
       Edim6       1.00      1.00      1.00         7
          Em       0.73      1.00      0.84         8
         Em6       1.00      1.00      1.00         7
        Em69       1.00      1.00      1.00         7
         Em7       0.77      1.00      0.87        10
       Em7-5       0.82      1.00      0.90         9
     Em7b9b5       0.86      1.00      0.92         6
         Em9       1.00      1.00      1.00        10
        EmM7       1.00      1.00      1.00         7
      Emadd9       0.88      1.00      0.93         7
       Emaj7       0.84      0.96      0.90        28
       Emaj9       0.93      0.96      0.95        28
       Esus2       1.00      1.00      1.00         7
       Esus4       1.00      1.00      1.00         7
           F       1.00      1.00      1.00         8
          F#       1.00      0.67      0.80         6
         F#2       0.61      0.95      0.75        20
         F#6       0.91      1.00      0.95        20
        F#69       0.86      0.90      0.88        20
         F#7       0.82      0.96      0.89        28
      F#7+11       0.91      1.00      0.95        20
       F#7+5       0.89      0.85      0.87        20
       F#7-5       0.68      0.85      0.76        20
       F#7-9       1.00      0.75      0.86        20
     F#7sus4       0.82      0.90      0.86        20
         F#9       0.93      1.00      0.97        28
     F#9sus4       0.94      0.75      0.83        20
      F#M7+5       0.86      0.90      0.88        20
     F#add11       0.76      0.95      0.84        20
      F#add9       0.93      0.70      0.80        20
       F#dim       0.80      0.67      0.73         6
      F#dim6       0.82      0.90      0.86        20
         F#m       1.00      1.00      1.00         6
        F#m6       0.86      0.90      0.88        20
       F#m69       1.00      0.65      0.79        20
        F#m7       0.85      1.00      0.92        11
      F#m7-5       0.95      0.68      0.79        28
    F#m7b9b5       1.00      1.00      1.00         6
        F#m9       0.85      1.00      0.92        11
       F#mM7       0.83      0.95      0.88        20
     F#madd9       0.81      0.85      0.83        20
      F#maj7       0.70      0.95      0.81        20
      F#maj9       0.75      0.90      0.82        20
      F#sus2       0.75      0.90      0.82        20
      F#sus4       0.86      0.95      0.90        20
          F2       0.95      0.64      0.77        28
          F6       1.00      1.00      1.00         7
         F69       0.95      1.00      0.98        21
          F7       1.00      1.00      1.00         9
       F7+11       1.00      1.00      1.00         7
        F7+5       1.00      1.00      1.00         7
        F7-5       1.00      1.00      1.00         7
        F7-9       1.00      1.00      1.00         7
      F7sus4       0.78      1.00      0.88         7
          F9       1.00      1.00      1.00         9
      F9sus4       1.00      1.00      1.00         7
         FM7       1.00      0.93      0.97        15
       FM7+5       0.88      1.00      0.93         7
         FM9       1.00      0.80      0.89         5
      Fadd11       1.00      1.00      1.00         7
       Fadd9       0.68      0.93      0.79        28
        Fdim       0.75      1.00      0.86         6
       Fdim6       0.88      1.00      0.93         7
          Fm       1.00      1.00      1.00         6
         Fm6       1.00      1.00      1.00         7
        Fm69       1.00      1.00      1.00         7
         Fm7       1.00      1.00      1.00        12
       Fm7-5       0.90      1.00      0.95         9
     Fm7b9b5       0.83      0.83      0.83         6
         Fm9       1.00      1.00      1.00        12
        FmM7       0.88      1.00      0.93         7
      Fmadd9       1.00      1.00      1.00         7
       Fmaj7       0.91      0.95      0.93        21
       Fmaj9       0.88      1.00      0.93         7
       Fsus2       1.00      1.00      1.00         7
       Fsus4       1.00      1.00      1.00         7
           G       0.89      1.00      0.94         8
         G#2       0.75      0.67      0.71        18
         G#6       1.00      0.33      0.50         6
        G#69       1.00      0.50      0.67         6
         G#7       1.00      0.50      0.67         6
      G#7+11       1.00      0.17      0.29         6
       G#7+5       0.79      0.79      0.79        24
       G#7-5       0.75      0.67      0.71        18
       G#7-9       1.00      0.75      0.86        24
     G#7sus4       0.75      0.50      0.60         6
         G#9       1.00      0.50      0.67         6
     G#9sus4       1.00      0.33      0.50         6
      G#M7+5       1.00      0.50      0.67         6
     G#add11       1.00      0.33      0.50         6
      G#add9       0.93      0.78      0.85        18
       G#dim       1.00      1.00      1.00         6
      G#dim6       1.00      0.50      0.67         6
         G#m       0.78      0.88      0.82         8
        G#m6       0.82      0.96      0.88        24
       G#m69       1.00      0.33      0.50         6
        G#m7       0.74      1.00      0.85        28
      G#m7-5       0.82      0.90      0.86        20
    G#m7b9b5       1.00      1.00      1.00         6
        G#m9       0.81      0.93      0.87        28
       G#mM7       0.95      0.83      0.89        24
     G#madd9       1.00      0.17      0.29         6
      G#maj7       0.80      0.67      0.73        18
      G#maj9       0.64      1.00      0.78        18
      G#sus2       1.00      0.50      0.67         6
      G#sus4       0.60      1.00      0.75         6
          G2       1.00      0.69      0.82        42
          G6       1.00      1.00      1.00         7
         G69       1.00      1.00      1.00         7
          G7       1.00      1.00      1.00         7
       G7+11       1.00      1.00      1.00         7
        G7+5       0.88      1.00      0.93         7
        G7-5       1.00      1.00      1.00         7
        G7-9       1.00      1.00      1.00         7
      G7sus4       1.00      1.00      1.00         7
          G9       1.00      1.00      1.00         7
      G9sus4       1.00      1.00      1.00         7
         GM7       0.64      0.78      0.70        18
       GM7+5       1.00      1.00      1.00         7
         GM9       1.00      0.17      0.29         6
      Gadd11       1.00      1.00      1.00         7
       Gadd9       0.69      0.89      0.78        28
          Gb       0.73      1.00      0.84         8
         Gb2       0.92      0.67      0.77        18
         Gb6       0.75      0.50      0.60         6
        Gb69       0.80      0.67      0.73         6
         Gb7       1.00      0.67      0.80         6
      Gb7+11       1.00      0.92      0.96        24
       Gb7+5       1.00      0.67      0.80         6
       Gb7-5       0.87      0.72      0.79        18
       Gb7-9       0.55      1.00      0.71         6
     Gb7sus4       1.00      0.83      0.91        18
         Gb9       1.00      0.67      0.80         6
     Gb9sus4       0.55      1.00      0.71         6
        GbM7       1.00      0.38      0.55         8
      GbM7+5       0.83      0.83      0.83        18
        GbM9       0.97      0.88      0.92        32
     Gbadd11       1.00      0.67      0.80         6
      Gbadd9       1.00      0.67      0.80         6
      Gbdim6       1.00      0.50      0.67         6
        Gbm6       1.00      0.67      0.80         6
       Gbm69       0.55      1.00      0.71         6
        Gbm7       1.00      0.33      0.50         6
      Gbm7-5       0.63      0.94      0.76        18
        Gbm9       0.80      0.67      0.73         6
       GbmM7       1.00      0.50      0.67         6
     Gbmadd9       1.00      0.50      0.67         6
      Gbmaj7       0.75      0.50      0.60         6
      Gbmaj9       1.00      0.50      0.67         6
      Gbsus2       1.00      0.67      0.80         6
      Gbsus4       1.00      0.50      0.67         6
        Gdim       0.86      1.00      0.92         6
       Gdim6       1.00      1.00      1.00         7
          Gm       0.75      1.00      0.86         6
         Gm6       1.00      1.00      1.00         7
        Gm69       1.00      1.00      1.00         7
         Gm7       1.00      1.00      1.00        10
       Gm7-5       0.90      1.00      0.95         9
     Gm7b9b5       1.00      1.00      1.00         6
         Gm9       1.00      1.00      1.00        10
        GmM7       0.83      0.90      0.86        21
      Gmadd9       1.00      1.00      1.00         7
       Gmaj7       0.90      0.64      0.75        28
       Gmaj9       0.82      0.96      0.89        28
       Gsus2       0.88      1.00      0.93         7
       Gsus4       0.88      1.00      0.93         7

    accuracy                           0.87      6965
   macro avg       0.91      0.87      0.87      6965
weighted avg       0.89      0.87      0.87      6965


Process finished with exit code 0
"""